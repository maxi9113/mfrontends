import { injectIntoHead } from '../helpers/domControllers';
const externalLoaderPlugin = (element, plugins, app) => {
    var _a, _b, _c;
    const plugin = (_a = plugins) === null || _a === void 0 ? void 0 : _a.find((p) => p.name === 'external-loader');
    const paths = (_c = (_b = plugin) === null || _b === void 0 ? void 0 : _b.options) === null || _c === void 0 ? void 0 : _c.paths;
    if (!paths || !paths.length || !app) {
        return;
    }
    const scriptTags = [];
    const styleTags = [];
    paths.forEach((path) => {
        const actualPath = typeof path === 'string' ? path : path.src;
        const async = typeof path === 'string' ? false : path.async;
        if (actualPath.endsWith('.js')) {
            const script = document.createElement('script');
            script.src = actualPath;
            script.async = async;
            scriptTags.push(script);
        }
        if (actualPath.endsWith('.css')) {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = actualPath;
            styleTags.push(link);
        }
    });
    scriptTags.forEach(injectIntoHead);
    const insertionPoint = document.createElement('span');
    insertionPoint.id = 'direflow_external-styles';
    styleTags.forEach((link) => insertionPoint.appendChild(link));
    return [app, insertionPoint];
};
export default externalLoaderPlugin;
